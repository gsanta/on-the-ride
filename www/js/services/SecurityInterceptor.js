// Generated by CoffeeScript 1.7.1
(function() {
  angular.module('services').factory('securityInterceptor', function($injector, SecurityRetryQueue) {
    return function(promise) {
      return promise.then(null, function(originalResponse) {
        console.log("login error");
        console.log(originalResponse.status);
        if (originalResponse.status === 401) {
          promise = SecurityRetryQueue.pushRetryFn('unauthorized-server', function() {
            return $injector.get('$http')(originalResponse.config);
          });
        }
        return promise;
      });
    };
  }).config(function($httpProvider) {
    return $httpProvider.responseInterceptors.push('securityInterceptor');
  });

}).call(this);
